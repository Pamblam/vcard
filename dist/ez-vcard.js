/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["VCard"] = factory();
	else
		root["VCard"] = factory();
})(this, () => {
return /******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/parser.js":
/*!***********************!*\
  !*** ./src/parser.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VCardParser: () => (/* binding */ VCardParser)\n/* harmony export */ });\nclass VCardParser{\n\n\tconstructor(text, vcard){\n\t\tthis.vcard = vcard;\n\t\tthis.text = text;\n\t\tthis.parse();\n\t}\n\n\ttokenizeVcardString(str){\n\t\tconst unesc = str => str.replace(/\\\\,/g, ',')\n\t\t\t.replace(/\\\\;/g, ';')\n\t\t\t.replace(/\\\\:/g, ':')\n\t\t\t.replace(/\\\\\\\\/g, '\\\\')\n\t\t\t.replace(/\\\\n/g, \"\\n\");\n\n\t\tlet tokens = str.replace(/\\n /g, '').split(/\\n+/g).map(line=>{\n\t\t\tvar [key_props, ...values] = line.match(/(\\\\.|[^:])+/g);\n\t\t\tvalues = (values.join(\":\").match(/(\\\\.|[^;])+/g)||[]).map(unesc);\n\n\t\t\tvar [key, ...props] = key_props.match(/(\\\\.|[^;])+/g);\n\t\t\tkey = unesc(key);\n\n\t\t\tprops = props.map(prop=>{\n\t\t\t\tlet [property, values] = prop.match(/(\\\\.|[^=])+/g);\n\t\t\t\tproperty = unesc(property);\n\n\t\t\t\tvalues = values.match(/(\\\\.|[^,])+/g).map(unesc);\n\t\t\t\treturn {property, values};\n\t\t\t});\n\n\t\t\treturn {key, props, values};\n\t\t});\n\n\t\t// Combine groups into single tokens\n\t\tlet label_map = {};\n\t\tfor(let i=0; i<tokens.length; i++){\n\t\t\tif(tokens[i].key.indexOf(\".\") > -1){\n\t\t\t\tlet [label, key] = tokens[i].key.split(\".\");\n\t\t\t\tif(!label_map.hasOwnProperty(label)){\n\t\t\t\t\ttokens[i].key = key;\n\t\t\t\t\tlabel_map[label] = i;\n\t\t\t\t}else{\n\t\t\t\t\tif(key === \"X-ABLabel\") key = \"LABEL\";\n\t\t\t\t\ttokens[label_map[label]].props.push({\n\t\t\t\t\t\tproperty: key, \n\t\t\t\t\t\tvalues: tokens[i].values\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\ttokens = tokens.filter(t=>t.key.indexOf(\".\") === -1);\n\t\treturn tokens;\n\t}\n\n\tparseFNToken(token){\n\t\tthis.vcard.setName(token.values[0]);\n\t}\n\n\tparseNicknameToken(token){\n\t\ttoken.values.forEach(n=>this.vcard.setNickname(n));\n\t}\n\n\tparsePhotoToken(token){\n\t\tif(this.vcard.specVersion === 3){\n\t\t\tlet type_prop = token.props.filter(p=>p.property.toUpperCase() === \"TYPE\");\n\t\t\tif(!type_prop.length || !type_prop[0].values || !type_prop[0].values.length){\n\t\t\t\tthrow new Error(\"Invalid vCard (Missing encoding)\");\n\t\t\t}\n\t\t\tthis.vcard.setPhoto(`data:image/${type_prop[0].values[0].toLowerCase()};base64,${token.values[0]}`);\n\t\t}else{\n\t\t\tthis.vcard.setPhoto(token.values.join(\";\"));\n\t\t}\n\t}\n\n\tparseBDayToken(token){\n\t\tvar [_, y, m, d, hr, mn, sec] = token.values[0]\n\t\t\t.replace(/[^\\d]*/g, '')\n\t\t\t.match(/^(\\d{4})(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{2})/)\n\t\t\t.map(n=>+n);\n\t\tthis.vcard.setBday(new Date(Date.UTC(y, m-1, d, hr, mn, sec)));\n\t}\n\n\tparseAnniversaryToken(token){\n\t\tvar [_, y, m, d, hr, mn, sec] = token.values[0]\n\t\t\t.replace(/[^\\d]*/g, '')\n\t\t\t.match(/^(\\d{4})(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{2})/)\n\t\t\t.map(n=>+n);\n\t\tthis.vcard.setAnniversary(new Date(Date.UTC(y, m-1, d, hr, mn, sec)));\n\t}\n\n\tparseGenderToken(token){\n\t\tthis.vcard.setGender(...token.values);\n\t}\n\n\tparseAddressToken(token){\n\t\tvar label_prop = token.props.filter(p=>p.property.toUpperCase() === \"LABEL\");\n\t\tvar label = label_prop.length ? label_prop[0].values[0] : '';\n\t\tthis.vcard.setAddress(...token.values, label);\n\t}\n\n\tparsePhoneToken(token){\n\t\tvar phone = '', ext = '', type = [], pref = false;\n\t\tphone = token.values[0].replace(/[^\\d]/g, '');\n\t\tif(phone.length === 11 && phone[0] === '1'){\n\t\t\tphone = phone.substring(1)\n\t\t}\n\t\tif(this.vcard.specVersion === 3){\n\t\t\tvar type_prop = token.props.filter(p=>p.property.toUpperCase() === \"TYPE\");\n\t\t\tif(type_prop.length){\n\t\t\t\tfor(let n=0; n<type_prop[0].values.length; n++){\n\t\t\t\t\tif(type_prop[0].values[n] === 'pref') pref = true;\n\t\t\t\t\telse type.push(type_prop[0].values[n]);\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tvar type_prop = token.props.filter(p=>p.property.toUpperCase() === \"TYPE\");\n\t\t\tif(type_prop.length) type = type_prop[0].values;\n\t\t\tvar pref_prop = token.props.filter(p=>p.property.toUpperCase() === \"PREF\");\n\t\t\tif(pref_prop.length) pref = true;\n\t\t\tif(token.values.length > 1) ext = token.values[1].replace(/[^\\d]/g, '');\n\t\t}\n\t\tthis.vcard.setPhone(phone, ext, type, pref);\n\t}\n\n\tparseEmailToken(token){\n\t\tlet email = token.values[0], pref = false;\n\t\tif(this.vcard.specVersion === 3){\n\t\t\tvar type_prop = token.props.filter(p=>p.property.toUpperCase() === \"TYPE\");\n\t\t\tif(type_prop.length){\n\t\t\t\tfor(let n=0; n<type_prop[0].values.length; n++){\n\t\t\t\t\tif(type_prop[0].values[n] === 'pref') pref = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tvar pref_prop = token.props.filter(p=>p.property.toUpperCase() === \"PREF\");\n\t\t\tif(pref_prop.length) pref = true;\n\t\t}\n\t\tthis.vcard.setEmail(email, pref);\n\t}\n\n\tparseIMToken(token){\n\t\tvar pref = false;\n\t\tvar pref_prop = token.props.filter(p=>p.property.toUpperCase() === \"PREF\");\n\t\tif(pref_prop.length) pref = true;\n\t\tvar [protocol, imurl] = token.values[0].split(\":\");\n\t\tthis.vcard.setIM(imurl, protocol, pref);\n\t}\n\n\tparseTitleToken(token){\n\t\tthis.vcard.setTitle(token.values[0]);\n\t}\n\n\tparseRoleToken(token){\n\t\tthis.vcard.setRole(token.values[0]);\n\t}\n\n\tparseLogoToken(token){\n\t\tif(this.vcard.specVersion === 3){\n\t\t\tlet type_prop = token.props.filter(p=>p.property.toUpperCase() === \"TYPE\");\n\t\t\tif(!type_prop.length || !type_prop[0].values || !type_prop[0].values.length){\n\t\t\t\tthrow new Error(\"Invalid vCard (Missing encoding)\");\n\t\t\t}\n\t\t\tthis.vcard.setLogo(`data:image/${type_prop[0].values[0].toLowerCase()};base64,${token.values[0]}`);\n\t\t}else{\n\t\t\tthis.vcard.setLogo(token.values.join(\";\"));\n\t\t}\n\t}\n\n\tparseOrgToken(token){\n\t\tthis.vcard.setOrg(...token.values);\n\t}\n\n\tparseNoteToken(token){\n\t\ttoken.values.forEach(note=>this.vcard.setNote(note));\n\t}\n\n\tparseURLToken(token){\n\t\ttoken.values.forEach(url=>this.vcard.setURL(url));\n\t}\n\n\tparseKindToken(token){\n\t\tthis.vcard.setKind(token.values[0]);\n\t}\n\n\tparseVersionToken(token){\n\t\tif(![\"3.0\", \"4.0\"].includes(token.values[0])){\n\t\t\tthrow new Error(\"Invalid or incompatible vCard version.\");\n\t\t}\n\t\tthis.vcard.setVersion(parseInt(token.values[0]));\n\t}\n\n\tparseToken(token){\n\t\tif(!token.key || !token.values || !token.values.length){\n\t\t\tthrow new Error(\"Invalid vCard (Invalid token)\");\n\t\t}\n\t\tswitch(token.key.toUpperCase()){\n\t\t\tcase \"VERSION\":\n\t\t\t\tthis.parseVersionToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"N\": break;\n\t\t\tcase \"FN\":\n\t\t\t\tthis.parseFNToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"KIND\":\n\t\t\t\tthis.parseKindToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"NICKNAME\":\n\t\t\t\tthis.parseNicknameToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"PHOTO\":\n\t\t\t\tthis.parsePhotoToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"BDAY\":\n\t\t\t\tthis.parseBDayToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"ANNIVERSARY\":\n\t\t\t\tthis.parseAnniversaryToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"GENDER\":\n\t\t\t\tthis.parseGenderToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"ADR\":\n\t\t\t\tthis.parseAddressToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"TEL\":\n\t\t\t\tthis.parsePhoneToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"EMAIL\":\n\t\t\t\tthis.parseEmailToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"IMPP\":\n\t\t\t\tthis.parseIMToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"TITLE\":\n\t\t\t\tthis.parseTitleToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"ROLE\":\n\t\t\t\tthis.parseRoleToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"LOGO\":\n\t\t\t\tthis.parseLogoToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"ORG\":\n\t\t\t\tthis.parseOrgToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"NOTE\":\n\t\t\t\tthis.parseNoteToken(token);\n\t\t\t\tbreak;\n\t\t\tcase \"URL\":\n\t\t\t\tthis.parseURLToken(token);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tparse(){\n\t\tlet tokens = this.tokenizeVcardString(this.text);\n\t\t\n\t\t// Check first\n\t\tlet begin = tokens.shift();\n\t\tif(begin.key.toUpperCase() !== \"BEGIN\" || !begin.values[0] || begin.values[0].toUpperCase() !== \"VCARD\"){\n\t\t\tthrow new Error(\"Invalid vCard\");\n\t\t}\n\n\t\t// Check the last line\n\t\tlet end = tokens.pop();\n\t\tif(end.key.toUpperCase() !== \"END\" || !end.values[0] || end.values[0].toUpperCase() !== \"VCARD\"){\n\t\t\tthrow new Error(\"Invalid vCard\");\n\t\t}\n\n\t\t// Version MUST be the first token\n\t\tif(tokens[0].key.toUpperCase() !== \"VERSION\"){\n\t\t\tthrow new Error(\"Version missing or out of place.\");\n\t\t}\n\n\t\tfor(let token_index = 0; token_index<tokens.length; token_index++){\n\t\t\tlet token = tokens[token_index];\n\t\t\tthis.parseToken(token);\n\t\t}\n\t}\n\n}\n\n//# sourceURL=webpack://VCard/./src/parser.js?");

/***/ }),

/***/ "./src/vcard.js":
/*!**********************!*\
  !*** ./src/vcard.js ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VCard: () => (/* binding */ VCard)\n/* harmony export */ });\n/* harmony import */ var _parser_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./parser.js */ \"./src/parser.js\");\n\n\n\n/**\n * Creates vCards in version 3 or version 4\n * Version 3 is defined in rfc2426 | https://www.rfc-editor.org/rfc/rfc2426\n * Version 4 is defined in rfc6350 | https://www.rfc-editor.org/rfc/rfc6350\n * See also: https://www.w3.org/2002/12/cal/vcard-notes.html\n * \n * Written by Rob Parham, August 2023\n * MIT License\n */\nclass VCard {\n\n\tconstructor(vCardText) {\n\t\tthis.specVersion = 4;\n\t\tthis.kind = null;\n\t\tthis.name = [];\n\t\tthis.nickname = [];\n\t\tthis.photo = [];\n\t\tthis.bday = null;\n\t\tthis.anniversary = null;\n\t\tthis.gender = null;\n\t\tthis.gender_ident = null;\n\t\tthis.address = [];\n\t\tthis.tel = [];\n\t\tthis.email = [];\n\t\tthis.impp = [];\n\t\tthis.title = [];\n\t\tthis.role = [];\n\t\tthis.logo = [];\n\t\tthis.org = [];\n\t\tthis.note = [];\n\t\tthis.url = [];\n\n\t\tthis.emailRegex = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|.(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\t\tthis.dataUriRegex = /^data:image\\/([^;]*);base64,(.*)$/;\n\n\t\tif(vCardText){\n\t\t\tnew _parser_js__WEBPACK_IMPORTED_MODULE_0__.VCardParser(vCardText, this);\n\t\t}\n\t}\n\n\tsetVersion(version){\n\t\tif(version !== 3 && version !== 4){\n\t\t\tthrow new Error('Unsupported version: '+version);\n\t\t}\n\t\tthis.specVersion = version;\n\t\treturn this;\n\t}\n\n\tsetNickname(nickname) {\n\t\tthis.nickname.push(nickname);\n\t\treturn this;\n\t}\n\n\tsetName(name) {\n\t\tthis.name.push(name.replace(/\\s+/g, ' ').trim());\n\t\treturn this;\n\t}\n\n\t/**\n\t * Supported in v4 only, ignored in v3\n\t */\n\tsetKind(kind) {\n\t\tkind = kind.trim().toLowerCase();\n\t\tlet allowed_values = [\n\t\t\tVCard.KIND_IND,\n\t\t\tVCard.KIND_GRP,\n\t\t\tVCard.KIND_ORG,\n\t\t\tVCard.KIND_LOC\n\t\t];\n\t\tif (!allowed_values.includes(kind)) {\n\t\t\tthrow new Error(\"Invalid Kind value.\");\n\t\t}\n\t\tthis.kind = kind;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Requires a Data URI, which will be converted to \n\t * the appropriate format upon rendering.\n\t */\n\tsetPhoto(dataURI) {\n\t\tif(!this.dataUriRegex.test(dataURI)){\n\t\t\tthrow new Error(\"Invalid Image Data URI\");\n\t\t}\n\t\tthis.photo.push(dataURI);\n\t\treturn this;\n\t}\n\n\tsetBday(bday) {\n\t\tif (!(bday instanceof Date)) {\n\t\t\tthrow new Error(\"Invalid Birthday date\");\n\t\t}\n\t\tthis.bday = bday;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Supported in v4 only, ignored in v3\n\t */\n\tsetAnniversary(anniversary) {\n\t\tif (!(anniversary instanceof Date)) {\n\t\t\tthrow new Error(\"Invalid Anniversary date\");\n\t\t}\n\t\tthis.anniversary = anniversary;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Supported in v4 only, ignored in v3\n\t */\n\tsetGender(gender, ident = null) {\n\t\tgender = gender;\n\t\tif (ident) ident = ident.trim().toLowerCase();\n\t\tlet allowed_values = [\n\t\t\tVCard.GENDER_MAL,\n\t\t\tVCard.GENDER_FEM,\n\t\t\tVCard.GENDER_OTH,\n\t\t\tVCard.GENDER_NON,\n\t\t\tVCard.GENDER_UNK\n\t\t];\n\t\tif (!allowed_values.includes(gender)) {\n\t\t\tthrow new Error(\"Invalid Gender value.\");\n\t\t}\n\t\tthis.gender = gender;\n\t\tthis.gender_ident = ident;\n\t\treturn this;\n\t}\n\n\tsetAddress(street = '', city = '', state = '', zip = '', country = '', label = '') {\n\t\tthis.address.push({ street, city, state, zip, country, label });\n\t\treturn this;\n\t}\n\n\t/**\n\t * Extention param supported in v4 only, ignored in v3\n\t */\n\tsetPhone(phone, ext='', type=[], pref=false){\n\t\tif(typeof type === 'string') type = [type];\n\t\tlet allowed_type_values = [\n\t\t\tVCard.TEL_TYPE_TXT,\n\t\t\tVCard.TEL_TYPE_VCE,\n\t\t\tVCard.TEL_TYPE_FAX,\n\t\t\tVCard.TEL_TYPE_CEL,\n\t\t\tVCard.TEL_TYPE_VID,\n\t\t\tVCard.TEL_TYPE_PAG,\n\t\t\tVCard.TEL_TYPE_TPH\n\t\t];\n\t\tfor(let i=0; i<type.length; i++){\n\t\t\tif (!allowed_type_values.includes(type[i])) {\n\t\t\t\tthrow new Error(\"Invalid Type value.\");\n\t\t\t}\n\t\t}\n\t\tif(pref){\n\t\t\tfor(let i=0; i<this.tel.length; i++){\n\t\t\t\tthis.tel[i].pref = false;\n\t\t\t}\n\t\t}\n\t\tthis.tel.push({phone, ext, type, pref: !!pref});\n\t\treturn this;\n\t}\n\n\tsetEmail(email, pref=false){\n\t\tif(!this.emailRegex.test(email.toLowerCase())){\n\t\t\tthrow new Error(\"Invalid Email value.\");\n\t\t}\n\t\tif(pref){\n\t\t\tfor(let i=0; i<this.email.length; i++){\n\t\t\t\tthis.email[i].pref = false;\n\t\t\t}\n\t\t}\n\t\tthis.email.push({email, pref: !!pref});\n\t\treturn this;\n\t}\n\n\t/**\n\t * Supported in v4 only, ignored in v3\n\t */\n\tsetIM(imurl, protocol, pref){\n\n\t\tconst allowed_protocols = [\n\t\t\tVCard.IM_PROTOCOL_SIP,\n\t\t\tVCard.IM_PROTOCOL_XMP,\n\t\t\tVCard.IM_PROTOCOL_IRC,\n\t\t\tVCard.IM_PROTOCOL_YMS,\n\t\t\tVCard.IM_PROTOCOL_MSN,\n\t\t\tVCard.IM_PROTOCOL_AIM,\n\t\t\tVCard.IM_PROTOCOL_IM\n\t\t];\n\n\t\tif (!allowed_protocols.includes(protocol)) {\n\t\t\tthrow new Error(\"Invalid Protocol value.\");\n\t\t}\n\n\t\tif(pref){\n\t\t\tfor(let i=0; i<this.impp.length; i++){\n\t\t\t\tthis.impp[i].pref = false;\n\t\t\t}\n\t\t}\n\t\tthis.impp.push({imurl, protocol, pref: !!pref});\n\t\treturn this;\n\t}\n\n\tsetTitle(title){\n\t\tthis.title.push(title);\n\t\treturn this;\n\t}\n\n\tsetRole(role){\n\t\tthis.role.push(role);\n\t\treturn this;\n\t}\n\n\tsetLogo(dataURI) {\n\t\tif(!this.dataUriRegex.test(dataURI)){\n\t\t\tthrow new Error(\"Invalid Image Data URI\");\n\t\t}\n\t\tthis.logo.push(dataURI);\n\t\treturn this;\n\t}\n\n\tsetOrg(org1, org2, org3){\n\t\tvar org = [];\n\t\tif(org1) org.push(org1);\n\t\tif(org2) org.push(org2);\n\t\tif(org3) org.push(org3);\n\t\tthis.org.push(org);\n\t\treturn this;\n\t}\n\n\tsetNote(note){\n\t\tthis.note.push(note);\n\t\treturn this;\n\t}\n\n\tsetURL(url){\n\t\tthis.url.push(url);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Escape comma, semicolon, colon, backslash and newlines and fold lines \n\t * at no more than 75 bytes per line, while keeping multi-byte characters \n\t * intact. This implementation uses tokens to represent comma, semicolon, \n\t * colon, and backslash which are converted to their literals and not \n\t * escaped.\n\t * \n\t * Version 3 and version 4 appear to be handle escaping and line folding \n\t * identically.\n\t * \n\t * Version 4 is defined here:\n\t * \t\trfc6350 3.2 line delimiting and folding\n\t * \t\trfc6350 3.4 property value escaping\n\t * \n\t * Version 3 is defined here:\n\t * \t\trfc2425 5.8.1 line delimiting and folding\n\t * \t\trfc2426 4 formal grammar\n\t */\n\tformatTextValue(str) {\n\t\tvar chars = [...str];\n\t\tvar max_line_bytes = 75;\n\t\tvar lines = [];\n\t\tvar curr_line = [];\n\t\tvar curr_line_bytes = 0;\n\t\tfor (let i = 0; i < chars.length; i++) {\n\t\t\tvar char = chars[i];\n\t\t\tif (char === ',') char = '\\\\,';\n\t\t\tif (char === ';') char = '\\\\;';\n\t\t\tif (char === ':') char = '\\\\:';\n\t\t\tif (char === '\\\\') char = '\\\\\\\\';\n\t\t\tif (char === \"\\n\") char = '\\\\n';\n\n\t\t\tif (char === '%') {\n\t\t\t\tlet token = chars.slice(i, i + 5).join('');\n\t\t\t\tswitch (token) {\n\t\t\t\t\tcase '%COM%':\n\t\t\t\t\t\tchar = ',';\n\t\t\t\t\t\ti += 4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase '%SEM%':\n\t\t\t\t\t\tchar = ';';\n\t\t\t\t\t\ti += 4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase '%COL%':\n\t\t\t\t\t\tchar = ':';\n\t\t\t\t\t\ti += 4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase '%BAC%':\n\t\t\t\t\t\tchar = '\\\\';\n\t\t\t\t\t\ti += 4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar char_bytes = new Blob([char]).size;\n\t\t\tif (curr_line_bytes + char_bytes > max_line_bytes) {\n\t\t\t\tlines.push(curr_line.join(''));\n\t\t\t\tcurr_line = [' ', char];\n\t\t\t\tcurr_line_bytes = 1 + char_bytes;\n\t\t\t} else {\n\t\t\t\tcurr_line.push(char);\n\t\t\t\tcurr_line_bytes += char_bytes;\n\t\t\t}\n\t\t}\n\t\tlines.push(curr_line.join(''));\n\t\treturn lines.join(\"\\n\");\n\t}\n\n\tformatDate(date) {\n\t\tvar [y, m, d, h, min, sec, ms] = date.toISOString().split(/[^\\d]+/);\n\t\tif(this.specVersion === 4){\n\t\t\treturn `${y}${m}${d}T${h}${min}${sec}Z`;\n\t\t}else{\n\t\t\treturn `${y}-${m}-${d}T${h}:${min}:${sec}Z`;\n\t\t}\n\t}\n\n\tasync render() {\n\t\tconst getGroup = (()=>{\n\t\t\tlet group = 0;\n\t\t\treturn ()=>{\n\t\t\t\tgroup++;\n\t\t\t\treturn `item${group}.`;\n\t\t\t};\n\t\t})();\n\n\t\tif(this.specVersion === 4){\n\t\t\tif (!this.kind) {\n\t\t\t\tthrow new Error('Missing Kind property (Required in Version 4)');\n\t\t\t}\n\t\t}\n\t\t\n\t\tif (!this.name.length) {\n\t\t\tthrow new Error(\"Missing Name property.\");\n\t\t}\n\n\t\tvar parts = [];\n\t\tparts.push('BEGIN:VCARD');\n\t\tparts.push(`VERSION:${this.specVersion}.0`);\n\n\t\tif(this.specVersion === 4){\n\t\t\tparts.push(`KIND:${this.kind}`);\n\t\t}\n\n\t\tfor (let i = 0; i < this.name.length; i++) {\n\t\t\tparts.push(this.formatTextValue(`FN%COL%${this.name[i]}`));\n\t\t\tif(i === 0){\n\t\t\t\tlet name_parts = this.name[i].split(' ');\n\t\t\t\tlet name = name_parts.pop();\n\t\t\t\tlet last_name = name_parts.join(' ');\n\t\t\t\tif(last_name) name += `%SEM%${last_name}`;\n\t\t\t\tparts.push(this.formatTextValue(`N%COL%${name}`));\n\t\t\t}\n\t\t}\n\n\t\tif (this.nickname.length) {\n\t\t\tfor(let i=0; i<this.nickname.length; i++){\n\t\t\t\tif(!this.nickname[i].trim()) continue;\n\t\t\t\tparts.push(`NICKNAME:${this.formatTextValue(this.nickname[i])}`);\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this.photo.length; i++) {\n\t\t\tlet photo = this.photo[i];\n\t\t\tif(this.specVersion === 4){\n\t\t\t\tphoto = photo.replace(/\\:/g, '%COL%').replace(/\\;/g, '%SEM%').replace(/\\,/g, '%COM%').replace(/\\\\/g, '%BAC%');\n\t\t\t\tparts.push(this.formatTextValue(`PHOTO%COL%${photo}`));\n\t\t\t}else{\n\t\t\t\tlet [_, type, data] = photo.match(this.dataUriRegex);\n\t\t\t\tdata = data.replace(/\\:/g, '%COL%').replace(/\\;/g, '%SEM%').replace(/\\,/g, '%COM%').replace(/\\\\/g, '%BAC%');\n\t\t\t\tparts.push(this.formatTextValue(`PHOTO%SEM%ENCODING=b%SEM%TYPE=${type.toUpperCase()}%COL%${data}`));\n\t\t\t}\n\t\t}\n\n\t\tif (this.bday) {\n\t\t\tparts.push(`BDAY:${this.formatDate(this.bday)}`);\n\t\t}\n\n\t\tif(this.specVersion === 4){\n\t\t\tif (this.anniversary) {\n\t\t\t\tparts.push(`ANNIVERSARY:${this.formatDate(this.anniversary)}`);\n\t\t\t}\n\t\t}\n\n\t\tif(this.specVersion === 4){\n\t\t\tif (this.gender) {\n\t\t\t\tlet gender = this.gender;\n\t\t\t\tif (this.gender_ident) gender += `%SEM%${this.gender_ident}`;\n\t\t\t\tparts.push(this.formatTextValue(`GENDER%COL%${gender}`));\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < this.address.length; i++) {\n\t\t\tlet group = '';\n\t\t\tif(this.specVersion === 3){\n\t\t\t\tgroup = getGroup();\n\t\t\t}\n\n\t\t\tlet adr = `${group}ADR`;\n\n\t\t\tif(this.specVersion === 4){\n\t\t\t\tif (this.address[i].label) {\n\t\t\t\t\tadr += `%SEM%LABEL=${this.address[i].label}`;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tadr += `%COL%%SEM%%SEM%`;\n\t\t\t\n\t\t\tif(this.address[i].street){\n\t\t\t\tadr += this.address[i].street;\n\t\t\t}\n\t\t\tadr += `%SEM%`;\n\n\t\t\tif(this.address[i].city){\n\t\t\t\tadr += this.address[i].city;\n\t\t\t}\n\t\t\tadr += `%SEM%`;\n\n\t\t\tif(this.address[i].state){\n\t\t\t\tadr += this.address[i].state;\n\t\t\t}\n\t\t\tadr += `%SEM%`;\n\n\t\t\tif(this.address[i].zip){\n\t\t\t\tadr += this.address[i].zip;\n\t\t\t}\n\t\t\tadr += `%SEM%`;\n\n\t\t\tif(this.address[i].country){\n\t\t\t\tadr += this.address[i].country;\n\t\t\t}\n\n\t\t\tparts.push(this.formatTextValue(adr));\n\n\t\t\tif(this.specVersion === 3){\n\t\t\t\tparts.push(this.formatTextValue(`${group}X-ABLabel%COL%${this.address[i].label}`));\n\t\t\t}\n\t\t}\n\n\t\tlet phone_type_map = {\n\t\t\ttext: 'cell',\n\t\t\tvoice: 'voice',\n\t\t\tfax: 'fax',\n\t\t\tcell: 'cell',\n\t\t\tvideo: 'video',\n\t\t\tpager: 'pager',\n\t\t\ttextphone: ''\n\t\t};\n\n\t\tfor(let i=0; i<this.tel.length; i++){\n\t\t\tlet tel = 'TEL';\n\n\t\t\tif(this.specVersion === 4){\n\t\t\t\ttel += '%SEM%VALUE=uri';\n\t\t\t\tif(this.tel[i].pref){\n\t\t\t\t\ttel += `%SEM%PREF=1`;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this.tel[i].type.length){\n\t\t\t\tlet type = this.tel[i].type;\n\t\t\t\tif(this.specVersion === 3){\n\t\t\t\t\ttype = type.map(t=>phone_type_map[t]).filter(t=>!!t);\n\t\t\t\t\tif(this.tel[i].pref){\n\t\t\t\t\t\ttype.push('pref');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttel += `%SEM%TYPE=${type.join('%COM%')}`;\n\t\t\t}\n\n\t\t\tlet ph_parts = this.tel[i].phone.replace(/[^\\d]/g, '').substring(0, 10).match(/^(\\d{0,3})(\\d{0,3})(\\d{0,4})/);\n\n\t\t\tif(this.specVersion === 4){\n\t\t\t\ttel += `%COL%tel%COL%+1-${ph_parts[1]}-${ph_parts[2]}-${ph_parts[3]}`;\n\t\t\t}else{\n\t\t\t\ttel += `%COL%+1-${ph_parts[1]}-${ph_parts[2]}-${ph_parts[3]}`;\n\t\t\t}\n\n\t\t\tif(this.specVersion === 4 && this.tel[i].ext){\n\t\t\t\ttel += `%SEM%ext=${this.tel[i].ext}`;\n\t\t\t}\n\n\t\t\tparts.push(this.formatTextValue(tel));\n\t\t}\n\n\t\tfor(let i=0; i<this.email.length; i++){\n\t\t\tlet em = 'EMAIL';\n\t\t\t\n\t\t\tif(this.specVersion === 4){\n\t\t\t\tif(this.email[i].pref){\n\t\t\t\t\tem += '%SEM%PREF=1';\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tem += '%SEM%TYPE=internet';\n\t\t\t\tif(this.email[i].pref){\n\t\t\t\t\tem += '%COM%pref';\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tem += `%COL%${this.email[i].email}`;\n\t\t\tparts.push(this.formatTextValue(em));\n\t\t}\n\n\t\tif(this.specVersion === 4){\n\t\t\tfor(let i=0; i<this.impp.length; i++){\n\t\t\t\tlet impp = 'IMPP';\n\t\t\t\tif(this.impp[i].pref){\n\t\t\t\t\timpp += '%SEM%PREF=1';\n\t\t\t\t}\n\t\t\t\timpp += `%COL%${this.impp[i].protocol}%COL%${this.impp[i].imurl}`;\n\t\t\t\tparts.push(this.formatTextValue(impp));\n\t\t\t}\n\t\t}\n\n\t\tfor(let i=0; i<this.title.length; i++){\n\t\t\tparts.push(this.formatTextValue(`TITLE%COL%${this.title[i]}`));\n\t\t}\n\n\t\tfor(let i=0; i<this.role.length; i++){\n\t\t\tparts.push(this.formatTextValue(`ROLE%COL%${this.role[i]}`));\n\t\t}\n\n\t\tfor (let i = 0; i < this.logo.length; i++) {\n\t\t\tlet logo = this.logo[i];\n\t\t\tif(this.specVersion === 4){\n\t\t\t\tlogo = logo.replace(/\\:/g, '%COL%').replace(/\\;/g, '%SEM%').replace(/\\,/g, '%COM%').replace(/\\\\/g, '%BAC%');\n\t\t\t\tparts.push(this.formatTextValue(`LOGO%COL%${logo}`));\n\t\t\t}else{\n\t\t\t\tlet [_, type, data] = logo.match(this.dataUriRegex);\n\t\t\t\tdata = data.replace(/\\:/g, '%COL%').replace(/\\;/g, '%SEM%').replace(/\\,/g, '%COM%').replace(/\\\\/g, '%BAC%');\n\t\t\t\tparts.push(this.formatTextValue(`LOGO%SEM%ENCODING=b%SEM%TYPE=${type.toUpperCase()}%COL%${data}`));\n\t\t\t}\n\t\t}\n\n\t\tfor(let i=0; i<this.org.length; i++){\n\t\t\tparts.push(this.formatTextValue(`ORG%COL%${this.org[i].join(`%SEM%`)}`));\n\t\t}\n\n\t\tfor(let i=0; i<this.note.length; i++){\n\t\t\tparts.push(this.formatTextValue(`NOTE%COL%${this.note[i]}`));\n\t\t}\n\n\t\tfor(let i=0; i<this.url.length; i++){\n\t\t\tparts.push(`URL:${this.url[i]}`);\n\t\t}\n\n\t\tparts.push('END:VCARD');\n\n\t\treturn parts.join(\"\\n\");\n\t}\n\t\t\n}\n\nVCard.IM_PROTOCOL_SIP = 'sip';\nVCard.IM_PROTOCOL_XMP = 'xmpp';\nVCard.IM_PROTOCOL_IRC = 'irc';\nVCard.IM_PROTOCOL_YMS = 'ymsgr';\nVCard.IM_PROTOCOL_MSN = 'msn';\nVCard.IM_PROTOCOL_AIM = 'aim';\nVCard.IM_PROTOCOL_IM = 'im';\n\nVCard.TEL_TYPE_TXT = 'text';\nVCard.TEL_TYPE_VCE = 'voice';\nVCard.TEL_TYPE_FAX = 'fax';\nVCard.TEL_TYPE_CEL = 'cell';\nVCard.TEL_TYPE_VID = 'video';\nVCard.TEL_TYPE_PAG = 'pager';\nVCard.TEL_TYPE_TPH = 'textphone';\n\nVCard.KIND_IND = 'individual';\nVCard.KIND_GRP = 'group';\nVCard.KIND_ORG = 'org';\nVCard.KIND_LOC = 'location';\n\nVCard.GENDER_MAL = 'M';\nVCard.GENDER_FEM = 'F';\nVCard.GENDER_OTH = 'O';\nVCard.GENDER_NON = 'N';\nVCard.GENDER_UNK = 'U';\n\n\n//# sourceURL=webpack://VCard/./src/vcard.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/vcard.js");
/******/ 	
/******/ 	return __webpack_exports__;
/******/ })()
;
});